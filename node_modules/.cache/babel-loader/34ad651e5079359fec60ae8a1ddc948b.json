{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"C:\\\\Users\\\\inaki\\\\OneDrive\\\\Documents\\\\Cours M2\\\\CSL\\\\projet_CSL\\\\nantes_prison_manager\\\\src\\\\view\\\\liberation.js\";\nimport React from 'react';\n\nfunction objectsEquals(o1, o2) {\n  return Object.keys(o1).length === Object.keys(o2).length && Object.keys(o1).every(p => o1[p] === o2[p]);\n}\n\nexport default class Liberation extends React.Component {\n  constructor() {\n    super();\n\n    this.compare = (a, b) => {\n      const nameA = a.lastname.toUpperCase();\n      const nameB = b.lastname.toUpperCase();\n      let comparison = 0;\n\n      if (nameA > nameB) {\n        comparison = 1;\n      } else if (nameA < nameB) {\n        comparison = -1;\n      }\n\n      return comparison;\n    };\n\n    this.createSelectItems = array => {\n      array.sort(this.compare);\n      let options = [];\n\n      for (let i = 0; i < array.length; i++) {\n        options.push( /*#__PURE__*/_jsxDEV(\"option\", {\n          id: i,\n          value: array[i].lastname + \" \" + array[i].firstname,\n          children: array[i].lastname + \" \" + array[i].firstname\n        }, i, false, {\n          fileName: _jsxFileName,\n          lineNumber: 51,\n          columnNumber: 26\n        }, this));\n      }\n\n      return options;\n    };\n\n    this.state = {\n      prisoners: [],\n      prisoners_updated: false\n    };\n  }\n\n  async componentDidMount() {\n    if (!this.state.prisoners_updated) {\n      this.getPrisoners();\n    }\n  }\n\n  async getPrisoners() {\n    await fetch('http://localhost:8080/prisoners/read', {\n      method: 'GET'\n    }) // Envoi requete au serveur\n    .then(res => res.json()) // Reponse de la requete\n    .then(out => {\n      // Données a recuperer\n      if (!objectsEquals(out, this.state.prisoners)) {\n        this.setState({\n          prisoners: out.result,\n          prisoners_updated: true\n        });\n      }\n    });\n  }\n\n  async deletePrisoner() {\n    let date_dec;\n\n    if (document.getElementById('date_decision').value !== \"\" && typeof document.getElementById('date_decision').value === 'string') {\n      date_dec = document.getElementById('date_decision').value;\n    } else throw new Error(\"view/liberation.js : deletePrisoner() -> date is empty or not a string\");\n\n    let select = document.getElementById(\"lib_select\");\n    let index = select.options[select.selectedIndex].id;\n    let array = this.state.prisoners.sort(this.compare);\n    let prisoner = {\n      lastname: array[index].lastname,\n      firstname: array[index].firstname\n    };\n    console.log(array[index]);\n    await fetch('http://localhost:8080/prisoners/delete', {\n      method: 'DELETE',\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        prisoner: prisoner\n      })\n    }).then(res => {\n      console.log('prisonier libéré');\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"Liberation\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Date decision : \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"date_decision\",\n          type: \"text\",\n          placeholder: \"dd/mm/aaaa\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Choisir prisonier :\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          id: \"lib_select\",\n          children: this.createSelectItems(this.state.prisoners)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          id: \"lib_valider\",\n          onClick: () => this.deletePrisoner(),\n          children: \"Valider\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 13\n    }, this);\n  }\n\n}","map":{"version":3,"sources":["C:/Users/inaki/OneDrive/Documents/Cours M2/CSL/projet_CSL/nantes_prison_manager/src/view/liberation.js"],"names":["React","objectsEquals","o1","o2","Object","keys","length","every","p","Liberation","Component","constructor","compare","a","b","nameA","lastname","toUpperCase","nameB","comparison","createSelectItems","array","sort","options","i","push","firstname","state","prisoners","prisoners_updated","componentDidMount","getPrisoners","fetch","method","then","res","json","out","setState","result","deletePrisoner","date_dec","document","getElementById","value","Error","select","index","selectedIndex","id","prisoner","console","log","headers","body","JSON","stringify","render"],"mappings":"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","sourcesContent":["import React from 'react';\r\n\r\nfunction objectsEquals(o1, o2){\r\n    return(Object.keys(o1).length === Object.keys(o2).length \r\n              && Object.keys(o1).every(p => o1[p] === o2[p]));\r\n}\r\n\r\nexport default class Liberation extends React.Component{\r\n\r\n    constructor(){\r\n        super()\r\n        this.state = {\r\n            prisoners: [],\r\n            prisoners_updated: false\r\n        }\r\n    }\r\n\r\n    async componentDidMount(){\r\n        if(!this.state.prisoners_updated){\r\n            this.getPrisoners();\r\n          }\r\n    }\r\n\r\n    async getPrisoners(){\r\n        await fetch('http://localhost:8080/prisoners/read', {method: 'GET'}) // Envoi requete au serveur\r\n              .then(res => res.json()) // Reponse de la requete\r\n              .then((out) => { // Données a recuperer\r\n                    if(!objectsEquals(out, this.state.prisoners)){\r\n                        this.setState({prisoners: out.result, prisoners_updated: true});\r\n                    }\r\n              });\r\n    }\r\n\r\n    compare = (a,b) => {\r\n        const nameA = a.lastname.toUpperCase();\r\n        const nameB = b.lastname.toUpperCase();\r\n\r\n        let comparison = 0;\r\n        if (nameA > nameB) {\r\n            comparison = 1;\r\n        } else if (nameA < nameB) {\r\n            comparison = -1;\r\n        }\r\n        return comparison;\r\n    }\r\n\r\n    createSelectItems = (array) => {\r\n        array.sort(this.compare);\r\n        let options = [];\r\n        for(let i=0; i<array.length; i++){\r\n            options.push(<option key={i} id={i} value={array[i].lastname +\" \"+ array[i].firstname}>{array[i].lastname + \" \" + array[i].firstname}</option>)\r\n        }\r\n        return options;\r\n    }\r\n\r\n    async deletePrisoner(){\r\n        let date_dec;\r\n        if(document.getElementById('date_decision').value !== \"\" && typeof document.getElementById('date_decision').value === 'string'){\r\n            date_dec = document.getElementById('date_decision').value;\r\n        }\r\n        else throw new Error(\"view/liberation.js : deletePrisoner() -> date is empty or not a string\");\r\n        let select = document.getElementById(\"lib_select\");\r\n        let index = select.options[select.selectedIndex].id;\r\n        let array = this.state.prisoners.sort(this.compare);\r\n        let prisoner = {\r\n            lastname: array[index].lastname,\r\n            firstname: array[index].firstname\r\n        }\r\n        console.log(array[index]);\r\n        await fetch('http://localhost:8080/prisoners/delete', \r\n                    {\r\n                        method:'DELETE',\r\n                        headers:{\"Content-Type\": \"application/json\"},\r\n                        body: JSON.stringify({prisoner: prisoner})\r\n                    }\r\n                )\r\n                .then((res) => {\r\n                    console.log('prisonier libéré');\r\n                });\r\n    }\r\n\r\n    render(){\r\n        return(\r\n            <div id=\"Liberation\">\r\n                <div>\r\n                    <p>Date decision : </p>\r\n                    <input id=\"date_decision\" type=\"text\" placeholder=\"dd/mm/aaaa\"></input>\r\n                </div>\r\n                <div>\r\n                    <p>Choisir prisonier :</p>\r\n                    <select id=\"lib_select\">\r\n                        {this.createSelectItems(this.state.prisoners)}\r\n                    </select>\r\n                </div>\r\n                <div>\r\n                    <button id=\"lib_valider\" onClick={() => this.deletePrisoner()}>Valider</button>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}